# Relai: 릴레이 연재 시스템 운영 정책

**작성자**: [왕택준](https://github.com/TJK98)

**문서 버전: 1.0**

본 문서는 Relai 플랫폼의 핵심 기능인 **릴레이 연재 시스템**의 운영 정책과 자동화된 처리 규칙을 정의합니다.

---

## **1. 소설의 핵심 상태 (`Novel Status`)**

모든 소설(`Novel`)은 현재의 진행 상황을 나타내는 아래 상태 중 하나를 가집니다.

| 상태명 (`status`)  | 설명                                      | 트리거 조건                      |
|:----------------|:----------------------------------------|:----------------------------|
| **`ONGOING`**   | **연재 진행 중**: 새로운 제안을 받거나 투표가 진행되는 정상 상태 | 소설 생성 시 기본 상태. 채택 완료 시에도 복귀 |
| **`COMPLETED`** | **완결**: 작성자가 공식적으로 종료한 상태. 이어쓰기 불가      | 작성자가 “완결하기” 실행              |
| **`HIDDEN`**    | **숨김(휴재)**: 장기 미업데이트로 시스템이 자동 비공개 처리    | 마지막 회차 등록 후 30일 경과 시        |

---

## **2. 제안의 상태 (`Proposal Status`)**

각 제안(`Proposal`)은 투표 및 채택 과정에서 다음 다섯 상태 중 하나를 가집니다.

| 상태명 (`status`) | 설명                                                                      | 전환 조건                |
|:---------------|:------------------------------------------------------------------------|:---------------------|
| **`VOTING`**   | 제안이 유효하게 등록되어 투표가 진행 중인 상태                                              | 제안 등록 시 기본 값         |
| **`PENDING`**  | 채택 대기 상태. 다음의 경우 발생:<br>① 단독 최다 득표<br>② 제안 1개뿐<br>③ 최다득표 동률<br>④ 무투표 발생 | 투표 마감 시점             |
| **`ADOPTED`**  | 공식 채택되어 다음 회차(`Chapter`)로 반영 완료                                         | 작성자 선택 / 자동 확정       |
| **`REJECTED`** | 채택되지 않은 제안                                                              | 채택 확정 시 나머지 제안 일괄 처리 |
| **`DELETED`**  | 사용자 철회 또는 운영자 삭제                                                        | 본인 삭제, 운영 정책 위반      |

---

## **3. 릴레이 라운드 규칙**

### **3.1. 투표 기간**

* **기간**: 새로운 회차(`Chapter`) 등록 시점을 기준으로 **72시간(3일)**
* **구현**: `vote_start_at = created_at`, `vote_end_at = vote_start_at + 72h`
* **목적**: 제안 간 공정한 경쟁 보장

---

### **3.2. 투표 규칙**

* **자기 투표 금지**: 본인 제안에는 투표 불가 (FE 비활성화 + BE 검증)
* **중복 투표 금지**: 1라운드 1인 1표 원칙

---

## **4. 투표 마감 시 자동 처리 규칙 (스케줄러)**

투표 종료(`vote_end_at`) 시 스케줄러는 제안 상태를 다음과 같이 전환합니다.

| 우선순위  | 상황 (Case)         | 처리 방안                            | 제안 상태                          |
|:------|:------------------|:---------------------------------|:-------------------------------|
| **1** | **단독 최다 득표**      | 해당 제안 → `PENDING` (자동 채택 대기)     | 승자: `ADOPTED`, 나머지: `REJECTED` |
| **2** | **제안 1개뿐**        | 단일 제안 → `PENDING`                | 단일 제안: `PENDING`               |
| **3** | **동률(복수 최다)**     | 동률군 전부 `PENDING`, 작성자 선택권 48h 부여 | 동률 제안: `PENDING`               |
| **4** | **무투표 동률 제안만 존재** | 모든 제안 `PENDING`, 작성자 선택권 48h 부여  | 모든 제안: `PENDING`               |
| **5** | **제안 없음 (1차)**    | 투표 기간 72h 연장                     | 변화 없음                          |
| **6** | **제안 없음 (2차)**    | 소설 상태 → `HIDDEN`                 | 변화 없음                          |

---

## **5. 장기 미업데이트 소설 처리**

* **규칙**: 마지막 회차 등록 후 30일 경과 → 소설 상태 `HIDDEN` 자동 전환
* **해제 조건**: 작성자가 ‘연재 재개’ 버튼 실행 시 다시 `ONGOING`
