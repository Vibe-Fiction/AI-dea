# Relai: 릴레이 연재 시스템 운영 정책

본 문서는 Relai 플랫폼의 릴레이 연재 기능을 안정적이고 공정하게 운영하기 위한 자동화 규칙과 정책을 정의한 문서입니다.
개발자, 기획자, 운영자가 동일한 기준으로 시스템을 이해하고 구현·관리할 수 있도록 가이드라인을 제공합니다.

**작성자**: [왕택준](https://github.com/TJK98)

**문서 버전:** v1.0

**대상 독자:** Relai 플랫폼 **개발자(Backend/Frontend)**, **기획자**, **운영자**

---

## **1. 소설의 핵심 상태 (`Novel Status`)**

모든 소설(`Novel`)은 현재의 진행 상황을 나타내는 아래 상태 중 하나를 가집니다.

| 상태명 (`status`)  | 설명                                      | 트리거 조건                      |
| :-------------- | :-------------------------------------- | :-------------------------- |
| **`ONGOING`**   | **연재 진행 중**: 새로운 제안을 받거나 투표가 진행되는 정상 상태 | 소설 생성 시 기본 상태. 채택 완료 시에도 복귀 |
| **`COMPLETED`** | **완결**: 작성자가 공식적으로 종료한 상태. 이어쓰기 불가      | 작성자가 “완결하기” 실행              |
| **`HIDDEN`**    | **숨김(휴재)**: 장기 미업데이트로 시스템이 자동 비공개 처리    | 마지막 회차 등록 후 30일 경과 시        |

> ⚠️ 현재 `Novel Status` Enum은 **추후 업데이트 예정**입니다. (현 단계에서는 DB 상태 컬럼으로만 관리)

---

## **2. 제안의 상태 (`Proposal Status`)**

각 제안(`Proposal`)은 투표 및 채택 과정에서 다음 다섯 상태 중 하나를 가집니다.

| 상태명 (`status`) | 설명                                        | 전환 조건                |
| :------------- | :---------------------------------------- | :------------------- |
| **`VOTING`**   | 제안이 유효하게 등록되어 투표가 진행 중인 상태                | 제안 등록 시 기본 값         |
| **`PENDING`**  | 채택 대기 상태. (동률, 무투표, 단일 제안) 작성자 확인 필요      | 투표 마감 시점             |
| **`ADOPTED`**  | **투표 종료 시 최다 득표안 자동 채택** / 작성자 선택에 의해 확정됨 | 투표 마감 → 스케줄러 자동 처리   |
| **`REJECTED`** | 채택되지 않은 제안                                | 채택 확정 시 나머지 제안 일괄 처리 |
| **`DELETED`**  | 사용자 철회 또는 운영자 삭제                          | 본인 삭제, 운영 정책 위반      |

---

## **3. 릴레이 라운드 규칙**

### **3.1. 투표 기간**

* **기간**: 새로운 회차(`Chapter`) 등록 시점을 기준으로 **72시간(3일)**
* **DB 컬럼 예시**: `votedAt` (투표 마감 시각)
* **목적**: 제안 간 공정한 경쟁 보장

---

### **3.2. 투표 규칙**

* **자기 투표 금지**: 본인 제안에는 투표 불가 (FE 비활성화 + BE 검증)
* **중복 투표 금지**: 1라운드 1인 1표 원칙

---

## **4. 투표 마감 시 자동 처리 규칙 (스케줄러)**

투표 종료(`votedAt` 경과) 시 스케줄러는 제안 상태를 다음과 같이 전환합니다.

| 우선순위  | 상황 (Case)         | 처리 방안                            | 제안 상태                          |
| :---- | :---------------- | :------------------------------- | :----------------------------- |
| **1** | **단독 최다 득표**      | **해당 제안 자동 `ADOPTED` 확정**        | 승자: `ADOPTED`, 나머지: `REJECTED` |
| **2** | **제안 1개뿐**        | 단일 제안 → `PENDING`                | 단일 제안: `PENDING`               |
| **3** | **동률(복수 최다)**     | 동률군 전부 `PENDING`, 작성자 선택권 48h 부여 | 동률 제안: `PENDING`               |
| **4** | **무투표 동률 제안만 존재** | 모든 제안 `PENDING`, 작성자 선택권 48h 부여  | 모든 제안: `PENDING`               |
| **5** | **제안 없음 (1차)**    | 투표 기간 72h 연장                     | 변화 없음                          |
| **6** | **제안 없음 (2차)**    | 소설 상태 → `HIDDEN`                 | 변화 없음                          |

---

## **5. 장기 미업데이트 소설 처리**

* **규칙**: 마지막 회차 등록 후 30일 경과 → 소설 상태 `HIDDEN` 자동 전환
* **해제 조건**: 작성자가 ‘연재 재개’ 버튼 실행 시 다시 `ONGOING`

---

## **6. 완결 정책**

* 릴레이 소설은 단일 작성자가 임의로 완결 선언할 수 없음.
* 완결 상태(`COMPLETED`) 전환 조건:

    1. **투표 기반 완결**: 참여자 과반수 이상이 동의할 경우 자동 완결 처리
    2. **자동 완결**: 신규 제안/회차가 90일간 없을 경우 시스템에서 자동 완결
    3. **운영자 강제 완결**: 저작권 침해, 트롤링, 정책 위반 발생 시 운영자가 강제로 완결 가능
* 완결 후 처리:

    * 이어쓰기/투표 불가, 읽기 전용 모드 전환
    * 작품 리스트에 `완결` 태그 표시
    * 재개는 운영자(Admin) 승인 시에만 가능

---

## **7. 추후 업데이트 계획**

1. **소설 상태 Enum 정식 도입**
   → `NovelStatus {ONGOING, COMPLETED, HIDDEN}` 로 코드와 DB에 반영.

2. **예외 처리 (작성자 탈퇴/비활성 계정)**

    * 투표 종료 시 작성자가 계정 비활성/탈퇴 상태라면, `PENDING` 제안은 누구도 처리할 수 없음.
    * 이 경우 \*\*운영자 계정(Admin)\*\*이 강제로 채택(`ADOPTED`) 혹은 거절(`REJECTED`)할 수 있는 권한을 제공.

3. **투표 기간 연장 표시**

    * FE/BE 모두에서 연장된 투표 마감 시각을 명확히 표시하도록 개선.
